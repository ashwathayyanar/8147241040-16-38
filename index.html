<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Advanced Customer Segmentation Platform</title>
    <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.3.2/papaparse.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/regression@2.0.1/dist/regression.min.js"></script>
    <style>
        :root {
            --primary: #2c3e50;
            --secondary: #3498db;
            --accent: #e74c3c;
            --success: #27ae60;
            --warning: #f39c12;
            --light: #ecf0f1;
            --dark: #2c3e50;
            --sidebar-width: 280px;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background-color: #f8f9fa;
            color: var(--dark);
            line-height: 1.6;
            display: flex;
            min-height: 100vh;
        }
        
        /* Sidebar Navigation */
        .sidebar {
            width: var(--sidebar-width);
            background: linear-gradient(180deg, var(--primary), #1a2530);
            color: white;
            padding: 1.5rem;
            position: fixed;
            height: 100vh;
            overflow-y: auto;
            box-shadow: 3px 0 10px rgba(0,0,0,0.1);
            z-index: 1000;
        }
        
        .logo {
            display: flex;
            align-items: center;
            margin-bottom: 2rem;
            padding-bottom: 1rem;
            border-bottom: 1px solid rgba(255,255,255,0.1);
        }
        
        .logo-icon {
            font-size: 2rem;
            margin-right: 10px;
        }
        
        .logo-text {
            font-size: 1.5rem;
            font-weight: bold;
        }
        
        .nav-menu {
            list-style: none;
        }
        
        .nav-item {
            margin-bottom: 0.5rem;
        }
        
        .nav-link {
            display: flex;
            align-items: center;
            padding: 0.8rem 1rem;
            color: rgba(255,255,255,0.8);
            text-decoration: none;
            border-radius: 8px;
            transition: all 0.3s ease;
        }
        
        .nav-link:hover, .nav-link.active {
            background-color: rgba(52, 152, 219, 0.2);
            color: white;
        }
        
        .nav-icon {
            margin-right: 10px;
            font-size: 1.2rem;
        }
        
        /* Main Content */
        .main-content {
            flex: 1;
            margin-left: var(--sidebar-width);
            padding: 2rem;
        }
        
        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 2rem;
            padding-bottom: 1rem;
            border-bottom: 1px solid #e0e0e0;
        }
        
        .header h1 {
            color: var(--primary);
            font-size: 2rem;
        }
        
        .user-menu {
            display: flex;
            align-items: center;
        }
        
        .user-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background-color: var(--secondary);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
            margin-right: 10px;
        }
        
        /* Dashboard Grid */
        .dashboard-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 1.5rem;
            margin-bottom: 2rem;
        }
        
        .metric-card {
            background: white;
            border-radius: 10px;
            padding: 1.5rem;
            box-shadow: 0 4px 6px rgba(0,0,0,0.05);
            border-left: 4px solid var(--secondary);
        }
        
        .metric-card.warning {
            border-left-color: var(--warning);
        }
        
        .metric-card.success {
            border-left-color: var(--success);
        }
        
        .metric-card.accent {
            border-left-color: var(--accent);
        }
        
        .metric-value {
            font-size: 2rem;
            font-weight: bold;
            margin: 0.5rem 0;
        }
        
        .metric-label {
            color: #7f8c8d;
            font-size: 0.9rem;
        }
        
        .metric-change {
            display: flex;
            align-items: center;
            font-size: 0.9rem;
            margin-top: 0.5rem;
        }
        
        .change-positive {
            color: var(--success);
        }
        
        .change-negative {
            color: var(--accent);
        }
        
        /* Content Sections */
        .content-section {
            background: white;
            border-radius: 10px;
            padding: 1.5rem;
            margin-bottom: 2rem;
            box-shadow: 0 4px 6px rgba(0,0,0,0.05);
        }
        
        .section-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
            padding-bottom: 0.5rem;
            border-bottom: 2px solid var(--light);
        }
        
        .section-title {
            color: var(--primary);
            font-size: 1.5rem;
        }
        
        /* Tabs */
        .tabs {
            display: flex;
            border-bottom: 1px solid #e0e0e0;
            margin-bottom: 1.5rem;
            flex-wrap: wrap;
        }
        
        .tab {
            padding: 0.8rem 1.5rem;
            cursor: pointer;
            border-bottom: 3px solid transparent;
            transition: all 0.3s ease;
        }
        
        .tab.active {
            border-bottom-color: var(--secondary);
            color: var(--secondary);
            font-weight: bold;
        }
        
        .tab-content {
            display: none;
        }
        
        .tab-content.active {
            display: block;
        }
        
        /* Charts */
        .charts-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(500px, 1fr));
            gap: 1.5rem;
        }
        
        .chart-container {
            background: white;
            border-radius: 10px;
            padding: 1.5rem;
            box-shadow: 0 4px 6px rgba(0,0,0,0.05);
            height: 400px;
        }
        
        /* Upload Area */
        .upload-area {
            border: 2px dashed var(--secondary);
            border-radius: 10px;
            padding: 3rem;
            text-align: center;
            margin-bottom: 1rem;
            transition: all 0.3s ease;
            cursor: pointer;
            background: rgba(52, 152, 219, 0.05);
        }
        
        .upload-area:hover {
            background-color: rgba(52, 152, 219, 0.1);
        }
        
        .upload-area.dragover {
            background-color: rgba(52, 152, 219, 0.15);
            border-color: var(--accent);
        }
        
        .upload-icon {
            font-size: 4rem;
            color: var(--secondary);
            margin-bottom: 1rem;
        }
        
        .file-input {
            display: none;
        }
        
        .btn {
            background-color: var(--secondary);
            color: white;
            border: none;
            padding: 0.8rem 1.5rem;
            border-radius: 5px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s ease;
            display: inline-flex;
            align-items: center;
            justify-content: center;
        }
        
        .btn:hover {
            background-color: #2980b9;
            transform: translateY(-2px);
        }
        
        .btn:active {
            transform: translateY(0);
        }
        
        .btn-accent {
            background-color: var(--accent);
        }
        
        .btn-accent:hover {
            background-color: #c0392b;
        }
        
        .btn-success {
            background-color: var(--success);
        }
        
        .btn-success:hover {
            background-color: #219a52;
        }
        
        .btn i {
            margin-right: 8px;
        }
        
        /* Data Table */
        .data-table-container {
            overflow-x: auto;
            margin-top: 1rem;
        }
        
        .data-table {
            width: 100%;
            border-collapse: collapse;
        }
        
        .data-table th, .data-table td {
            padding: 0.75rem;
            text-align: left;
            border-bottom: 1px solid #e0e0e0;
        }
        
        .data-table th {
            background-color: #f8f9fa;
            font-weight: bold;
            color: var(--primary);
        }
        
        .data-table tr:hover {
            background-color: #f5f5f5;
        }
        
        /* Progress Bar */
        .progress-container {
            width: 100%;
            background-color: #e0e0e0;
            border-radius: 5px;
            margin: 1rem 0;
            overflow: hidden;
        }
        
        .progress-bar {
            height: 10px;
            background-color: var(--secondary);
            border-radius: 5px;
            width: 0%;
            transition: width 0.3s ease;
        }
        
        /* Alert Messages */
        .alert {
            padding: 1rem;
            border-radius: 5px;
            margin-bottom: 1rem;
            display: flex;
            align-items: center;
        }
        
        .alert-success {
            background-color: #d4edda;
            color: #155724;
            border-left: 4px solid var(--success);
        }
        
        .alert-error {
            background-color: #f8d7da;
            color: #721c24;
            border-left: 4px solid var(--accent);
        }
        
        .alert-warning {
            background-color: #fff3cd;
            color: #856404;
            border-left: 4px solid var(--warning);
        }
        
        .alert-icon {
            margin-right: 10px;
            font-size: 1.2rem;
        }
        
        /* Loading Spinner */
        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid rgba(255,255,255,0.3);
            border-radius: 50%;
            border-top-color: white;
            animation: spin 1s linear infinite;
            margin-right: 10px;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        
        /* Responsive Design */
        @media (max-width: 1024px) {
            .sidebar {
                width: 80px;
                padding: 1rem 0.5rem;
            }
            
            .logo-text, .nav-text {
                display: none;
            }
            
            .nav-link {
                justify-content: center;
                padding: 0.8rem;
            }
            
            .nav-icon {
                margin-right: 0;
                font-size: 1.5rem;
            }
            
            .main-content {
                margin-left: 80px;
            }
        }
        
        @media (max-width: 768px) {
            .dashboard-grid {
                grid-template-columns: 1fr;
            }
            
            .charts-grid {
                grid-template-columns: 1fr;
            }
            
            .chart-container {
                height: 300px;
            }
        }
        
        /* Advanced Controls */
        .advanced-controls {
            background: #f8f9fa;
            border-radius: 8px;
            padding: 1.5rem;
            margin: 1.5rem 0;
        }
        
        .control-group {
            margin-bottom: 1rem;
        }
        
        .control-label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: bold;
            color: var(--primary);
        }
        
        .control-input {
            width: 100%;
            padding: 0.8rem;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-size: 1rem;
        }
        
        .slider-container {
            display: flex;
            align-items: center;
            gap: 1rem;
        }
        
        .slider {
            flex: 1;
        }
        
        .slider-value {
            min-width: 50px;
            text-align: center;
            font-weight: bold;
        }
        
        /* Segment Cards */
        .segments-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 1.5rem;
        }
        
        .segment-card {
            background: white;
            border-radius: 10px;
            padding: 1.5rem;
            box-shadow: 0 4px 6px rgba(0,0,0,0.05);
            border-top: 4px solid var(--secondary);
            transition: transform 0.3s ease;
        }
        
        .segment-card:hover {
            transform: translateY(-5px);
        }
        
        .segment-card.gold {
            border-top-color: #FFD700;
        }
        
        .segment-card.silver {
            border-top-color: #C0C0C0;
        }
        
        .segment-card.bronze {
            border-top-color: #CD7F32;
        }
        
        .segment-card.platinum {
            border-top-color: #E5E4E2;
        }
        
        .segment-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
        }
        
        .segment-name {
            font-weight: bold;
            font-size: 1.2rem;
        }
        
        .segment-badge {
            background: var(--secondary);
            color: white;
            padding: 0.3rem 0.8rem;
            border-radius: 20px;
            font-size: 0.8rem;
        }
        
        .segment-stats {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 0.5rem;
            margin-top: 1rem;
        }
        
        .segment-stat {
            text-align: center;
            padding: 0.5rem;
            background: #f8f9fa;
            border-radius: 5px;
        }
        
        .stat-value {
            font-weight: bold;
            font-size: 1.1rem;
        }
        
        .stat-label {
            font-size: 0.8rem;
            color: #7f8c8d;
        }
        
        /* Analytics Grid */
        .analytics-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
            gap: 1.5rem;
        }
        
        .analytics-card {
            background: white;
            border-radius: 10px;
            padding: 1.5rem;
            box-shadow: 0 4px 6px rgba(0,0,0,0.05);
        }
        
        .prediction-results {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 1.5rem;
        }
        
        .prediction-card {
            background: white;
            border-radius: 10px;
            padding: 1.5rem;
            box-shadow: 0 4px 6px rgba(0,0,0,0.05);
            border-left: 4px solid var(--secondary);
        }
        
        .prediction-value {
            font-size: 2rem;
            font-weight: bold;
            margin: 0.5rem 0;
        }
        
        .prediction-label {
            color: #7f8c8d;
            font-size: 0.9rem;
        }
        
        .hidden {
            display: none;
        }
    </style>
</head>
<body>
    <!-- Sidebar Navigation -->
    <nav class="sidebar">
        <div class="logo">
            <div class="logo-icon">üìä</div>
            <div class="logo-text">CustomerIQ</div>
        </div>
        <ul class="nav-menu">
            <li class="nav-item">
                <a href="#" class="nav-link active" data-target="dashboard">
                    <span class="nav-icon">üìà</span>
                    <span class="nav-text">Dashboard</span>
                </a>
            </li>
            <li class="nav-item">
                <a href="#" class="nav-link" data-target="data-upload">
                    <span class="nav-icon">üì§</span>
                    <span class="nav-text">Data Upload</span>
                </a>
            </li>
            <li class="nav-item">
                <a href="#" class="nav-link" data-target="segmentation">
                    <span class="nav-icon">üéØ</span>
                    <span class="nav-text">Segmentation</span>
                </a>
            </li>
            <li class="nav-item">
                <a href="#" class="nav-link" data-target="analytics">
                    <span class="nav-icon">üîç</span>
                    <span class="nav-text">Advanced Analytics</span>
                </a>
            </li>
            <li class="nav-item">
                <a href="#" class="nav-link" data-target="predictions">
                    <span class="nav-icon">üîÆ</span>
                    <span class="nav-text">Predictions</span>
                </a>
            </li>
            <li class="nav-item">
                <a href="#" class="nav-link" data-target="reports">
                    <span class="nav-icon">üìã</span>
                    <span class="nav-text">Reports</span>
                </a>
            </li>
        </ul>
    </nav>

    <!-- Main Content -->
    <main class="main-content">
        <!-- Header -->
        <div class="header">
            <h1>Customer Segmentation Dashboard</h1>
            <div class="user-menu">
                <div class="user-avatar">JD</div>
                <div>
                    <div>John Doe</div>
                    <div style="font-size: 0.8rem; color: #7f8c8d;">Administrator</div>
                </div>
            </div>
        </div>

        <!-- Dashboard Section -->
        <section id="dashboard" class="content-section active">
            <div class="section-header">
                <h2 class="section-title">Overview</h2>
                <div class="date-range">Last 30 days</div>
            </div>
            
            <!-- Key Metrics -->
            <div class="dashboard-grid">
                <div class="metric-card">
                    <div class="metric-label">Total Customers</div>
                    <div class="metric-value">12,458</div>
                    <div class="metric-change change-positive">
                        <span>+5.2%</span> from last month
                    </div>
                </div>
                <div class="metric-card success">
                    <div class="metric-label">Active Customers</div>
                    <div class="metric-value">8,742</div>
                    <div class="metric-change change-positive">
                        <span>+2.1%</span> from last month
                    </div>
                </div>
                <div class="metric-card warning">
                    <div class="metric-label">Avg. Order Value</div>
                    <div class="metric-value">$142.50</div>
                    <div class="metric-change change-negative">
                        <span>-1.3%</span> from last month
                    </div>
                </div>
                <div class="metric-card accent">
                    <div class="metric-label">Customer Retention</div>
                    <div class="metric-value">78.4%</div>
                    <div class="metric-change change-positive">
                        <span>+3.7%</span> from last month
                    </div>
                </div>
            </div>
            
            <!-- Charts -->
            <div class="charts-grid">
                <div class="chart-container">
                    <div id="segmentation-chart"></div>
                </div>
                <div class="chart-container">
                    <div id="trend-chart"></div>
                </div>
                <div class="chart-container">
                    <div id="geographic-chart"></div>
                </div>
                <div class="chart-container">
                    <div id="rfm-chart"></div>
                </div>
            </div>
            
            <!-- Recent Activity -->
            <div class="content-section">
                <div class="section-header">
                    <h2 class="section-title">Recent Activity</h2>
                    <button class="btn btn-accent">View All</button>
                </div>
                <div class="data-table-container">
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>Customer</th>
                                <th>Segment</th>
                                <th>Last Purchase</th>
                                <th>Lifetime Value</th>
                                <th>Status</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>Michael Johnson</td>
                                <td><span class="segment-badge" style="background: #FFD700;">Gold</span></td>
                                <td>2 days ago</td>
                                <td>$4,250</td>
                                <td><span style="color: var(--success);">Active</span></td>
                            </tr>
                            <tr>
                                <td>Sarah Williams</td>
                                <td><span class="segment-badge" style="background: #E5E4E2;">Platinum</span></td>
                                <td>5 days ago</td>
                                <td>$8,750</td>
                                <td><span style="color: var(--success);">Active</span></td>
                            </tr>
                            <tr>
                                <td>Robert Brown</td>
                                <td><span class="segment-badge" style="background: #C0C0C0;">Silver</span></td>
                                <td>2 weeks ago</td>
                                <td>$1,200</td>
                                <td><span style="color: var(--warning);">At Risk</span></td>
                            </tr>
                            <tr>
                                <td>Jennifer Davis</td>
                                <td><span class="segment-badge" style="background: #CD7F32;">Bronze</span></td>
                                <td>1 month ago</td>
                                <td>$450</td>
                                <td><span style="color: var(--accent);">Inactive</span></td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </section>

        <!-- Data Upload Section -->
        <section id="data-upload" class="content-section hidden">
            <div class="section-header">
                <h2 class="section-title">Data Upload & Management</h2>
            </div>
            
            <div class="alert alert-warning">
                <span class="alert-icon">‚ö†Ô∏è</span>
                <div>
                    <strong>Data Privacy:</strong> Your data is processed locally in your browser and never sent to our servers.
                </div>
            </div>
            
            <div class="upload-area" id="uploadArea">
                <div class="upload-icon">üì§</div>
                <h3>Drag & Drop your customer data file here</h3>
                <p>or</p>
                <button class="btn" id="browseBtn">
                    <i>üìÅ</i> Browse Files
                </button>
                <input type="file" id="fileInput" class="file-input" accept=".csv,.xlsx,.xls,.json">
                <p>Supported formats: CSV, Excel (XLSX, XLS), JSON</p>
            </div>
            
            <div id="fileInfo" class="hidden">
                <div class="alert alert-success">
                    <span class="alert-icon">‚úÖ</span>
                    <div>
                        <strong>File uploaded successfully!</strong>
                        <div id="fileName"></div>
                    </div>
                </div>
                
                <div class="advanced-controls">
                    <h3>Data Configuration</h3>
                    <div class="control-group">
                        <label class="control-label">Data Sampling (for large datasets)</label>
                        <div class="slider-container">
                            <input type="range" min="1" max="100" value="100" class="slider" id="samplingSlider">
                            <span class="slider-value" id="samplingValue">100%</span>
                        </div>
                    </div>
                    
                    <div class="control-group">
                        <label class="control-label">Memory Optimization</label>
                        <select class="control-input" id="memoryOption">
                            <option value="balanced">Balanced (Recommended)</option>
                            <option value="performance">Performance (More RAM)</option>
                            <option value="conservative">Conservative (Less RAM)</option>
                        </select>
                    </div>
                    
                    <button class="btn btn-success" id="processDataBtn">
                        <i>‚ö°</i> Process Data
                    </button>
                </div>
            </div>
            
            <div id="dataPreview" class="hidden">
                <div class="section-header">
                    <h3 class="section-title">Data Preview</h3>
                    <button class="btn btn-accent" id="analyzeDataBtn">
                        <i>üîç</i> Analyze Data
                    </button>
                </div>
                <div class="data-table-container">
                    <div id="previewTable"></div>
                </div>
            </div>
            
            <div id="processingProgress" class="hidden">
                <div class="section-header">
                    <h3 class="section-title">Processing Data</h3>
                </div>
                <div class="progress-container">
                    <div class="progress-bar" id="progressBar"></div>
                </div>
                <div id="progressText">Initializing...</div>
            </div>
        </section>

        <!-- Segmentation Section -->
        <section id="segmentation" class="content-section hidden">
            <div class="section-header">
                <h2 class="section-title">Customer Segmentation</h2>
                <div>
                    <button class="btn" id="runSegmentationBtn">
                        <i>üéØ</i> Run Segmentation
                    </button>
                    <button class="btn btn-success" id="exportSegmentsBtn">
                        <i>üì•</i> Export
                    </button>
                </div>
            </div>
            
            <div class="tabs">
                <div class="tab active" data-tab="segments-overview">Segments Overview</div>
                <div class="tab" data-tab="segment-details">Segment Details</div>
                <div class="tab" data-tab="segment-comparison">Segment Comparison</div>
                <div class="tab" data-tab="customer-profiles">Customer Profiles</div>
            </div>
            
            <div class="tab-content active" id="segments-overview">
                <div class="segments-grid">
                    <div class="segment-card platinum">
                        <div class="segment-header">
                            <div class="segment-name">Platinum</div>
                            <div class="segment-badge">12%</div>
                        </div>
                        <p>High-value loyal customers with frequent purchases</p>
                        <div class="segment-stats">
                            <div class="segment-stat">
                                <div class="stat-value">$1,240</div>
                                <div class="stat-label">Avg. Spend</div>
                            </div>
                            <div class="segment-stat">
                                <div class="stat-value">18</div>
                                <div class="stat-label">Avg. Orders</div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="segment-card gold">
                        <div class="segment-header">
                            <div class="segment-name">Gold</div>
                            <div class="segment-badge">23%</div>
                        </div>
                        <p>Regular customers with good spending habits</p>
                        <div class="segment-stats">
                            <div class="segment-stat">
                                <div class="stat-value">$580</div>
                                <div class="stat-label">Avg. Spend</div>
                            </div>
                            <div class="segment-stat">
                                <div class="stat-value">9</div>
                                <div class="stat-label">Avg. Orders</div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="segment-card silver">
                        <div class="segment-header">
                            <div class="segment-name">Silver</div>
                            <div class="segment-badge">35%</div>
                        </div>
                        <p>Occasional customers with moderate spending</p>
                        <div class="segment-stats">
                            <div class="segment-stat">
                                <div class="stat-value">$210</div>
                                <div class="stat-label">Avg. Spend</div>
                            </div>
                            <div class="segment-stat">
                                <div class="stat-value">4</div>
                                <div class="stat-label">Avg. Orders</div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="segment-card bronze">
                        <div class="segment-header">
                            <div class="segment-name">Bronze</div>
                            <div class="segment-badge">30%</div>
                        </div>
                        <p>New or low-engagement customers</p>
                        <div class="segment-stats">
                            <div class="segment-stat">
                                <div class="stat-value">$85</div>
                                <div class="stat-label">Avg. Spend</div>
                            </div>
                            <div class="segment-stat">
                                <div class="stat-value">1.5</div>
                                <div class="stat-label">Avg. Orders</div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="charts-grid" style="margin-top: 2rem;">
                    <div class="chart-container">
                        <div id="segmentation-pie-chart"></div>
                    </div>
                    <div class="chart-container">
                        <div id="segmentation-bar-chart"></div>
                    </div>
                </div>
            </div>
            
            <div class="tab-content" id="segment-details">
                <div class="section-header">
                    <h3 class="section-title">Segment Analysis</h3>
                    <select id="segmentSelector" class="control-input" style="width: 200px;">
                        <option value="platinum">Platinum Segment</option>
                        <option value="gold">Gold Segment</option>
                        <option value="silver">Silver Segment</option>
                        <option value="bronze">Bronze Segment</option>
                    </select>
                </div>
                
                <div class="charts-grid">
                    <div class="chart-container">
                        <div id="segment-purchase-trend"></div>
                    </div>
                    <div class="chart-container">
                        <div id="segment-product-mix"></div>
                    </div>
                    <div class="chart-container">
                        <div id="segment-geographic-dist"></div>
                    </div>
                    <div class="chart-container">
                        <div id="segment-demographics"></div>
                    </div>
                </div>
                
                <div class="content-section">
                    <h3>Segment Insights</h3>
                    <div id="segment-insights">
                        <p>Detailed insights for the selected segment will appear here after analysis.</p>
                    </div>
                </div>
            </div>
            
            <div class="tab-content" id="segment-comparison">
                <div class="charts-grid">
                    <div class="chart-container">
                        <div id="comparison-rfm-chart"></div>
                    </div>
                    <div class="chart-container">
                        <div id="comparison-ltv-chart"></div>
                    </div>
                    <div class="chart-container">
                        <div id="comparison-retention-chart"></div>
                    </div>
                    <div class="chart-container">
                        <div id="comparison-scatter-chart"></div>
                    </div>
                </div>
                
                <div class="content-section">
                    <h3>Segment Comparison Metrics</h3>
                    <div class="data-table-container">
                        <table class="data-table" id="comparison-table">
                            <thead>
                                <tr>
                                    <th>Metric</th>
                                    <th>Platinum</th>
                                    <th>Gold</th>
                                    <th>Silver</th>
                                    <th>Bronze</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>Avg. Lifetime Value</td>
                                    <td>$4,250</td>
                                    <td>$1,850</td>
                                    <td>$750</td>
                                    <td>$210</td>
                                </tr>
                                <tr>
                                    <td>Purchase Frequency</td>
                                    <td>18.2</td>
                                    <td>9.5</td>
                                    <td>4.1</td>
                                    <td>1.8</td>
                                </tr>
                                <tr>
                                    <td>Avg. Order Value</td>
                                    <td>$234</td>
                                    <td>$195</td>
                                    <td>$183</td>
                                    <td>$117</td>
                                </tr>
                                <tr>
                                    <td>Retention Rate</td>
                                    <td>94%</td>
                                    <td>82%</td>
                                    <td>67%</td>
                                    <td>42%</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
            
            <div class="tab-content" id="customer-profiles">
                <div class="section-header">
                    <h3 class="section-title">Customer Profile Analysis</h3>
                    <button class="btn" id="generateProfilesBtn">
                        <i>üë§</i> Generate Profiles
                    </button>
                </div>
                
                <div class="charts-grid">
                    <div class="chart-container">
                        <div id="profile-demographics-chart"></div>
                    </div>
                    <div class="chart-container">
                        <div id="profile-behavior-chart"></div>
                    </div>
                </div>
                
                <div class="content-section">
                    <h3>Customer Personas</h3>
                    <div class="segments-grid">
                        <div class="segment-card">
                            <div class="segment-header">
                                <div class="segment-name">Loyal Linda</div>
                                <div class="segment-badge">Platinum</div>
                            </div>
                            <p><strong>Demographics:</strong> Female, 45-60, Urban</p>
                            <p><strong>Behavior:</strong> Shops weekly, responds to email campaigns</p>
                            <p><strong>Preferences:</strong> Premium products, loyalty rewards</p>
                        </div>
                        
                        <div class="segment-card">
                            <div class="segment-header">
                                <div class="segment-name">Bargain Bob</div>
                                <div class="segment-badge">Bronze</div>
                            </div>
                            <p><strong>Demographics:</strong> Male, 25-40, Suburban</p>
                            <p><strong>Behavior:</strong> Shops during sales, price-sensitive</p>
                            <p><strong>Preferences:</strong> Discounts, value bundles</p>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Analytics Section -->
        <section id="analytics" class="content-section hidden">
            <div class="section-header">
                <h2 class="section-title">Advanced Analytics</h2>
                <button class="btn" id="runAdvancedAnalyticsBtn">
                    <i>üî¨</i> Run Analysis
                </button>
            </div>
            
            <div class="tabs">
                <div class="tab active" data-tab="clustering">Clustering Analysis</div>
                <div class="tab" data-tab="trends">Trend Analysis</div>
                <div class="tab" data-tab="cohort">Cohort Analysis</div>
                <div class="tab" data-tab="correlation">Correlation Analysis</div>
            </div>
            
            <div class="tab-content active" id="clustering">
                <div class="advanced-controls">
                    <h3>Clustering Parameters</h3>
                    <div class="control-group">
                        <label class="control-label">Number of Clusters</label>
                        <div class="slider-container">
                            <input type="range" min="2" max="8" value="4" class="slider" id="clusterSlider">
                            <span class="slider-value" id="clusterValue">4</span>
                        </div>
                    </div>
                    
                    <div class="control-group">
                        <label class="control-label">Clustering Algorithm</label>
                        <select class="control-input" id="clusterAlgorithm">
                            <option value="kmeans">K-Means</option>
                            <option value="dbscan">DBSCAN</option>
                            <option value="hierarchical">Hierarchical</option>
                        </select>
                    </div>
                    
                    <button class="btn btn-success" id="runClusteringBtn">
                        <i>üîç</i> Run Clustering
                    </button>
                </div>
                
                <div class="charts-grid">
                    <div class="chart-container">
                        <div id="cluster-scatter-plot"></div>
                    </div>
                    <div class="chart-container">
                        <div id="cluster-silhouette-plot"></div>
                    </div>
                </div>
                
                <div class="content-section">
                    <h3>Cluster Characteristics</h3>
                    <div class="data-table-container">
                        <table class="data-table" id="cluster-table">
                            <thead>
                                <tr>
                                    <th>Cluster</th>
                                    <th>Size</th>
                                    <th>Avg. Recency</th>
                                    <th>Avg. Frequency</th>
                                    <th>Avg. Monetary</th>
                                    <th>Segment</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>Cluster 1</td>
                                    <td>312</td>
                                    <td>15 days</td>
                                    <td>18.5</td>
                                    <td>$1,240</td>
                                    <td>Platinum</td>
                                </tr>
                                <tr>
                                    <td>Cluster 2</td>
                                    <td>598</td>
                                    <td>28 days</td>
                                    <td>9.2</td>
                                    <td>$580</td>
                                    <td>Gold</td>
                                </tr>
                                <tr>
                                    <td>Cluster 3</td>
                                    <td>912</td>
                                    <td>45 days</td>
                                    <td>4.1</td>
                                    <td>$210</td>
                                    <td>Silver</td>
                                </tr>
                                <tr>
                                    <td>Cluster 4</td>
                                    <td>782</td>
                                    <td>78 days</td>
                                    <td>1.8</td>
                                    <td>$85</td>
                                    <td>Bronze</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
            
            <div class="tab-content" id="trends">
                <div class="charts-grid">
                    <div class="chart-container">
                        <div id="revenue-trend-chart"></div>
                    </div>
                    <div class="chart-container">
                        <div id="customer-trend-chart"></div>
                    </div>
                    <div class="chart-container">
                        <div id="seasonality-chart"></div>
                    </div>
                    <div class="chart-container">
                        <div id="product-trend-chart"></div>
                    </div>
                </div>
                
                <div class="content-section">
                    <h3>Trend Insights</h3>
                    <div id="trend-insights">
                        <p><strong>Key Findings:</strong></p>
                        <ul>
                            <li>Revenue has grown 15% year-over-year, with Platinum customers contributing 42% of total revenue</li>
                            <li>Customer acquisition costs have decreased by 8% while retention has improved by 12%</li>
                            <li>Seasonal peaks occur in Q4 (holiday season) and Q2 (spring promotions)</li>
                            <li>Product category "Electronics" shows the strongest growth at 24% year-over-year</li>
                        </ul>
                    </div>
                </div>
            </div>
            
            <div class="tab-content" id="cohort">
                <div class="charts-grid">
                    <div class="chart-container">
                        <div id="cohort-retention-chart"></div>
                    </div>
                    <div class="chart-container">
                        <div id="cohort-revenue-chart"></div>
                    </div>
                </div>
                
                <div class="content-section">
                    <h3>Cohort Analysis Results</h3>
                    <div class="data-table-container">
                        <table class="data-table" id="cohort-table">
                            <thead>
                                <tr>
                                    <th>Cohort</th>
                                    <th>Customers</th>
                                    <th>Month 1</th>
                                    <th>Month 3</th>
                                    <th>Month 6</th>
                                    <th>Month 12</th>
                                    <th>LTV</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>Jan 2023</td>
                                    <td>245</td>
                                    <td>100%</td>
                                    <td>78%</td>
                                    <td>65%</td>
                                    <td>52%</td>
                                    <td>$1,240</td>
                                </tr>
                                <tr>
                                    <td>Feb 2023</td>
                                    <td>312</td>
                                    <td>100%</td>
                                    <td>82%</td>
                                    <td>68%</td>
                                    <td>55%</td>
                                    <td>$1,310</td>
                                </tr>
                                <tr>
                                    <td>Mar 2023</td>
                                    <td>278</td>
                                    <td>100%</td>
                                    <td>85%</td>
                                    <td>72%</td>
                                    <td>58%</td>
                                    <td>$1,420</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
            
            <div class="tab-content" id="correlation">
                <div class="charts-grid">
                    <div class="chart-container">
                        <div id="correlation-matrix"></div>
                    </div>
                    <div class="chart-container">
                        <div id="correlation-heatmap"></div>
                    </div>
                </div>
                
                <div class="content-section">
                    <h3>Correlation Insights</h3>
                    <div id="correlation-insights">
                        <p><strong>Key Correlations:</strong></p>
                        <ul>
                            <li><strong>Strong positive correlation (0.82)</strong> between purchase frequency and customer lifetime value</li>
                            <li><strong>Moderate negative correlation (-0.65)</strong> between recency and likelihood of repeat purchase</li>
                            <li><strong>Weak positive correlation (0.32)</strong> between customer age and average order value</li>
                            <li>Product categories "Electronics" and "Accessories" show strong cross-purchase patterns (0.76)</li>
                        </ul>
                    </div>
                </div>
            </div>
        </section>

        <!-- Predictions Section -->
        <section id="predictions" class="content-section hidden">
            <div class="section-header">
                <h2 class="section-title">Customer Predictions</h2>
                <button class="btn" id="runPredictionsBtn">
                    <i>üîÆ</i> Generate Predictions
                </button>
            </div>
            
            <div class="tabs">
                <div class="tab active" data-tab="churn">Churn Prediction</div>
                <div class="tab" data-tab="ltv">Lifetime Value</div>
                <div class="tab" data-tab="next-purchase">Next Purchase</div>
                <div class="tab" data-tab="propensity">Propensity Models</div>
            </div>
            
            <div class="tab-content active" id="churn">
                <div class="prediction-results">
                    <div class="prediction-card">
                        <div class="prediction-label">Overall Churn Rate</div>
                        <div class="prediction-value">12.4%</div>
                        <div class="metric-change change-negative">
                            <span>+1.2%</span> from last quarter
                        </div>
                    </div>
                    
                    <div class="prediction-card">
                        <div class="prediction-label">At-Risk Customers</div>
                        <div class="prediction-value">847</div>
                        <div class="metric-change change-negative">
                            <span>+8%</span> from last month
                        </div>
                    </div>
                    
                    <div class="prediction-card">
                        <div class="prediction-label">Churn Prevention Success</div>
                        <div class="prediction-value">34%</div>
                        <div class="metric-change change-positive">
                            <span>+5%</span> from last quarter
                        </div>
                    </div>
                </div>
                
                <div class="charts-grid">
                    <div class="chart-container">
                        <div id="churn-segment-chart"></div>
                    </div>
                    <div class="chart-container">
                        <div id="churn-reasons-chart"></div>
                    </div>
                </div>
                
                <div class="content-section">
                    <h3>Churn Risk by Segment</h3>
                    <div class="data-table-container">
                        <table class="data-table" id="churn-table">
                            <thead>
                                <tr>
                                    <th>Segment</th>
                                    <th>Customers</th>
                                    <th>At Risk</th>
                                    <th>Churn Rate</th>
                                    <th>Avg. Risk Score</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>Platinum</td>
                                    <td>312</td>
                                    <td>18</td>
                                    <td>5.8%</td>
                                    <td>0.24</td>
                                </tr>
                                <tr>
                                    <td>Gold</td>
                                    <td>598</td>
                                    <td>74</td>
                                    <td>12.4%</td>
                                    <td>0.41</td>
                                </tr>
                                <tr>
                                    <td>Silver</td>
                                    <td>912</td>
                                    <td>215</td>
                                    <td>23.6%</td>
                                    <td>0.63</td>
                                </tr>
                                <tr>
                                    <td>Bronze</td>
                                    <td>782</td>
                                    <td>540</td>
                                    <td>69.1%</td>
                                    <td>0.82</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
            
            <div class="tab-content" id="ltv">
                <div class="prediction-results">
                    <div class="prediction-card">
                        <div class="prediction-label">Avg. Customer Lifetime Value</div>
                        <div class="prediction-value">$1,245</div>
                        <div class="metric-change change-positive">
                            <span>+8.2%</span> from last year
                        </div>
                    </div>
                    
                    <div class="prediction-card">
                        <div class="prediction-label">High-Value Customers (LTV > $2,500)</div>
                        <div class="prediction-value">428</div>
                        <div class="metric-change change-positive">
                            <span>+12%</span> from last quarter
                        </div>
                    </div>
                    
                    <div class="prediction-card">
                        <div class="prediction-label">LTV Prediction Accuracy</div>
                        <div class="prediction-value">87.3%</div>
                        <div class="metric-change change-positive">
                            <span>+2.1%</span> model improvement
                        </div>
                    </div>
                </div>
                
                <div class="charts-grid">
                    <div class="chart-container">
                        <div id="ltv-distribution-chart"></div>
                    </div>
                    <div class="chart-container">
                        <div id="ltv-prediction-chart"></div>
                    </div>
                </div>
                
                <div class="content-section">
                    <h3>LTV by Acquisition Channel</h3>
                    <div class="data-table-container">
                        <table class="data-table" id="ltv-table">
                            <thead>
                                <tr>
                                    <th>Acquisition Channel</th>
                                    <th>Customers</th>
                                    <th>Avg. LTV</th>
                                    <th>LTV/CAC Ratio</th>
                                    <th>Payback Period</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>Organic Search</td>
                                    <td>1,245</td>
                                    <td>$1,850</td>
                                    <td>4.2</td>
                                    <td>5.2 months</td>
                                </tr>
                                <tr>
                                    <td>Referral</td>
                                    <td>892</td>
                                    <td>$1,620</td>
                                    <td>3.8</td>
                                    <td>6.1 months</td>
                                </tr>
                                <tr>
                                    <td>Social Media</td>
                                    <td>745</td>
                                    <td>$1,210</td>
                                    <td>2.9</td>
                                    <td>7.8 months</td>
                                </tr>
                                <tr>
                                    <td>Paid Search</td>
                                    <td>1,102</td>
                                    <td>$980</td>
                                    <td>2.1</td>
                                    <td>9.4 months</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
            
            <div class="tab-content" id="next-purchase">
                <div class="prediction-results">
                    <div class="prediction-card">
                        <div class="prediction-label">Next Purchase Accuracy</div>
                        <div class="prediction-value">76.8%</div>
                        <div class="metric-change change-positive">
                            <span>+3.2%</span> model improvement
                        </div>
                    </div>
                    
                    <div class="prediction-card">
                        <div class="prediction-label">Avg. Days to Next Purchase</div>
                        <div class="prediction-value">34</div>
                        <div class="metric-change change-negative">
                            <span>+2 days</span> from last quarter
                        </div>
                    </div>
                    
                    <div class="prediction-card">
                        <div class="prediction-label">Recommended Product Match</div>
                        <div class="prediction-value">68%</div>
                        <div class="metric-change change-positive">
                            <span>+7%</span> from last model
                        </div>
                    </div>
                </div>
                
                <div class="charts-grid">
                    <div class="chart-container">
                        <div id="next-purchase-timing"></div>
                    </div>
                    <div class="chart-container">
                        <div id="product-affinity"></div>
                    </div>
                </div>
                
                <div class="content-section">
                    <h3>Next Purchase Recommendations</h3>
                    <div class="data-table-container">
                        <table class="data-table" id="next-purchase-table">
                            <thead>
                                <tr>
                                    <th>Customer Segment</th>
                                    <th>Avg. Days to Purchase</th>
                                    <th>Recommended Product Category</th>
                                    <th>Confidence Score</th>
                                    <th>Expected Value</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>Platinum</td>
                                    <td>18</td>
                                    <td>Premium Electronics</td>
                                    <td>84%</td>
                                    <td>$285</td>
                                </tr>
                                <tr>
                                    <td>Gold</td>
                                    <td>32</td>
                                    <td>Home Appliances</td>
                                    <td>76%</td>
                                    <td>$165</td>
                                </tr>
                                <tr>
                                    <td>Silver</td>
                                    <td>47</td>
                                    <td>Accessories</td>
                                    <td>68%</td>
                                    <td>$85</td>
                                </tr>
                                <tr>
                                    <td>Bronze</td>
                                    <td>72</td>
                                    <td>Consumables</td>
                                    <td>52%</td>
                                    <td>$45</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
            
            <div class="tab-content" id="propensity">
                <div class="charts-grid">
                    <div class="chart-container">
                        <div id="propensity-scores"></div>
                    </div>
                    <div class="chart-container">
                        <div id="propensity-lift"></div>
                    </div>
                </div>
                
                <div class="content-section">
                    <h3>Propensity Model Performance</h3>
                    <div class="data-table-container">
                        <table class="data-table" id="propensity-table">
                            <thead>
                                <tr>
                                    <th>Model</th>
                                    <th>Accuracy</th>
                                    <th>Precision</th>
                                    <th>Recall</th>
                                    <th>F1 Score</th>
                                    <th>AUC</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>Churn Prediction</td>
                                    <td>87.2%</td>
                                    <td>83.5%</td>
                                    <td>76.8%</td>
                                    <td>80.0%</td>
                                    <td>0.89</td>
                                </tr>
                                <tr>
                                    <td>Upsell Propensity</td>
                                    <td>79.4%</td>
                                    <td>75.2%</td>
                                    <td>71.8%</td>
                                    <td>73.4%</td>
                                    <td>0.82</td>
                                </tr>
                                <tr>
                                    <td>Cross-sell Propensity</td>
                                    <td>72.6%</td>
                                    <td>68.9%</td>
                                    <td>65.4%</td>
                                    <td>67.1%</td>
                                    <td>0.76</td>
                                </tr>
                                <tr>
                                    <td>Promotion Response</td>
                                    <td>81.3%</td>
                                    <td>78.5%</td>
                                    <td>74.2%</td>
                                    <td>76.3%</td>
                                    <td>0.85</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </section>

        <!-- Reports Section -->
        <section id="reports" class="content-section hidden">
            <div class="section-header">
                <h2 class="section-title">Reports & Exports</h2>
                <button class="btn btn-success" id="generateReportBtn">
                    <i>üìÑ</i> Generate Full Report
                </button>
            </div>
            
            <div class="tabs">
                <div class="tab active" data-tab="standard">Standard Reports</div>
                <div class="tab" data-tab="custom">Custom Reports</div>
                <div class="tab" data-tab="exports">Data Exports</div>
            </div>
            
            <div class="tab-content active" id="standard">
                <div class="segments-grid">
                    <div class="segment-card">
                        <div class="segment-header">
                            <div class="segment-name">Customer Segmentation Report</div>
                        </div>
                        <p>Complete analysis of customer segments with RFM metrics</p>
                        <div class="segment-stats">
                            <div class="segment-stat">
                                <div class="stat-value">24</div>
                                <div class="stat-label">Pages</div>
                            </div>
                            <div class="segment-stat">
                                <div class="stat-value">12</div>
                                <div class="stat-label">Charts</div>
                            </div>
                        </div>
                        <button class="btn" style="width: 100%; margin-top: 1rem;">
                            <i>üì•</i> Download PDF
                        </button>
                    </div>
                    
                    <div class="segment-card">
                        <div class="segment-header">
                            <div class="segment-name">Performance Dashboard</div>
                        </div>
                        <p>Key metrics and performance indicators for management</p>
                        <div class="segment-stats">
                            <div class="segment-stat">
                                <div class="stat-value">16</div>
                                <div class="stat-label">Pages</div>
                            </div>
                            <div class="segment-stat">
                                <div class="stat-value">8</div>
                                <div class="stat-label">Charts</div>
                            </div>
                        </div>
                        <button class="btn" style="width: 100%; margin-top: 1rem;">
                            <i>üì•</i> Download PDF
                        </button>
                    </div>
                    
                    <div class="segment-card">
                        <div class="segment-header">
                            <div class="segment-name">Monthly Analytics</div>
                        </div>
                        <p>Monthly performance review with trend analysis</p>
                        <div class="segment-stats">
                            <div class="segment-stat">
                                <div class="stat-value">18</div>
                                <div class="stat-label">Pages</div>
                            </div>
                            <div class="segment-stat">
                                <div class="stat-value">10</div>
                                <div class="stat-label">Charts</div>
                            </div>
                        </div>
                        <button class="btn" style="width: 100%; margin-top: 1rem;">
                            <i>üì•</i> Download PDF
                        </button>
                    </div>
                    
                    <div class="segment-card">
                        <div class="segment-header">
                            <div class="segment-name">Executive Summary</div>
                        </div>
                        <p>High-level insights and recommendations for executives</p>
                        <div class="segment-stats">
                            <div class="segment-stat">
                                <div class="stat-value">8</div>
                                <div class="stat-label">Pages</div>
                            </div>
                            <div class="segment-stat">
                                <div class="stat-value">6</div>
                                <div class="stat-label">Charts</div>
                            </div>
                        </div>
                        <button class="btn" style="width: 100%; margin-top: 1rem;">
                            <i>üì•</i> Download PDF
                        </button>
                    </div>
                </div>
            </div>
            
            <div class="tab-content" id="custom">
                <div class="advanced-controls">
                    <h3>Custom Report Builder</h3>
                    
                    <div class="control-group">
                        <label class="control-label">Report Type</label>
                        <select class="control-input" id="reportType">
                            <option value="segmentation">Customer Segmentation</option>
                            <option value="performance">Performance Analysis</option>
                            <option value="predictive">Predictive Analytics</option>
                            <option value="comparative">Comparative Analysis</option>
                        </select>
                    </div>
                    
                    <div class="control-group">
                        <label class="control-label">Time Period</label>
                        <select class="control-input" id="timePeriod">
                            <option value="last30">Last 30 Days</option>
                            <option value="last90">Last 90 Days</option>
                            <option value="lastYear">Last Year</option>
                            <option value="custom">Custom Range</option>
                        </select>
                    </div>
                    
                    <div class="control-group">
                        <label class="control-label">Segments to Include</label>
                        <div>
                            <label><input type="checkbox" checked> Platinum</label>
                            <label><input type="checkbox" checked> Gold</label>
                            <label><input type="checkbox" checked> Silver</label>
                            <label><input type="checkbox" checked> Bronze</label>
                        </div>
                    </div>
                    
                    <div class="control-group">
                        <label class="control-label">Metrics to Include</label>
                        <div>
                            <label><input type="checkbox" checked> RFM Analysis</label>
                            <label><input type="checkbox" checked> Customer Lifetime Value</label>
                            <label><input type="checkbox" checked> Churn Analysis</label>
                            <label><input type="checkbox" checked> Purchase Patterns</label>
                            <label><input type="checkbox" checked> Geographic Distribution</label>
                        </div>
                    </div>
                    
                    <button class="btn btn-success" id="buildReportBtn">
                        <i>üõ†Ô∏è</i> Build Custom Report
                    </button>
                </div>
            </div>
            
            <div class="tab-content" id="exports">
                <div class="segments-grid">
                    <div class="segment-card">
                        <div class="segment-header">
                            <div class="segment-name">Customer Segments</div>
                        </div>
                        <p>Complete customer segmentation data with RFM scores</p>
                        <div class="segment-stats">
                            <div class="segment-stat">
                                <div class="stat-value">CSV</div>
                                <div class="stat-label">Format</div>
                            </div>
                            <div class="segment-stat">
                                <div class="stat-value">2,604</div>
                                <div class="stat-label">Rows</div>
                            </div>
                        </div>
                        <button class="btn" style="width: 100%; margin-top: 1rem;">
                            <i>üì•</i> Export Data
                        </button>
                    </div>
                    
                    <div class="segment-card">
                        <div class="segment-header">
                            <div class="segment-name">Transaction History</div>
                        </div>
                        <p>Complete transaction history with product details</p>
                        <div class="segment-stats">
                            <div class="segment-stat">
                                <div class="stat-value">CSV</div>
                                <div class="stat-label">Format</div>
                            </div>
                            <div class="segment-stat">
                                <div class="stat-value">45,812</div>
                                <div class="stat-label">Rows</div>
                            </div>
                        </div>
                        <button class="btn" style="width: 100%; margin-top: 1rem;">
                            <i>üì•</i> Export Data
                        </button>
                    </div>
                    
                    <div class="segment-card">
                        <div class="segment-header">
                            <div class="segment-name">Customer Profiles</div>
                        </div>
                        <p>Detailed customer profiles with demographic data</p>
                        <div class="segment-stats">
                            <div class="segment-stat">
                                <div class="stat-value">JSON</div>
                                <div class="stat-label">Format</div>
                            </div>
                            <div class="segment-stat">
                                <div class="stat-value">12,458</div>
                                <div class="stat-label">Rows</div>
                            </div>
                        </div>
                        <button class="btn" style="width: 100%; margin-top: 1rem;">
                            <i>üì•</i> Export Data
                        </button>
                    </div>
                    
                    <div class="segment-card">
                        <div class="segment-header">
                            <div class="segment-name">Analytics Dataset</div>
                        </div>
                        <p>Processed dataset ready for advanced analytics</p>
                        <div class="segment-stats">
                            <div class="segment-stat">
                                <div class="stat-value">XLSX</div>
                                <div class="stat-label">Format</div>
                            </div>
                            <div class="segment-stat">
                                <div class="stat-value">8.7 MB</div>
                                <div class="stat-label">Size</div>
                            </div>
                        </div>
                        <button class="btn" style="width: 100%; margin-top: 1rem;">
                            <i>üì•</i> Export Data
                        </button>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <script>
        // Global variables
        let currentData = null;
        let processedData = null;
        let segmentationResults = null;
        let analyticsResults = null;
        let predictionResults = null;
        
        // Initialize the application
        document.addEventListener('DOMContentLoaded', function() {
            initializeNavigation();
            initializeEventListeners();
            initializeSampleCharts();
            initializeSampleData();
        });
        
        function initializeNavigation() {
            // Navigation menu event listeners
            const navLinks = document.querySelectorAll('.nav-link');
            navLinks.forEach(link => {
                link.addEventListener('click', function(e) {
                    e.preventDefault();
                    
                    // Remove active class from all links
                    navLinks.forEach(l => l.classList.remove('active'));
                    
                    // Add active class to clicked link
                    this.classList.add('active');
                    
                    // Hide all sections
                    const sections = document.querySelectorAll('.content-section');
                    sections.forEach(section => section.classList.add('hidden'));
                    
                    // Show target section
                    const target = this.getAttribute('data-target');
                    document.getElementById(target).classList.remove('hidden');
                });
            });
            
            // Tab navigation
            const tabs = document.querySelectorAll('.tab');
            tabs.forEach(tab => {
                tab.addEventListener('click', function() {
                    const tabId = this.getAttribute('data-tab');
                    
                    // Remove active class from all tabs
                    tabs.forEach(t => t.classList.remove('active'));
                    
                    // Add active class to clicked tab
                    this.classList.add('active');
                    
                    // Hide all tab contents
                    const tabContents = document.querySelectorAll('.tab-content');
                    tabContents.forEach(content => content.classList.remove('active'));
                    
                    // Show target tab content
                    document.getElementById(tabId).classList.add('active');
                    
                    // Initialize tab-specific content if needed
                    if (tabId === 'segment-details') {
                        updateSegmentDetails();
                    } else if (tabId === 'segment-comparison') {
                        updateSegmentComparison();
                    } else if (tabId === 'clustering') {
                        updateClusteringAnalysis();
                    } else if (tabId === 'trends') {
                        updateTrendAnalysis();
                    } else if (tabId === 'cohort') {
                        updateCohortAnalysis();
                    } else if (tabId === 'correlation') {
                        updateCorrelationAnalysis();
                    } else if (tabId === 'churn') {
                        updateChurnPredictions();
                    } else if (tabId === 'ltv') {
                        updateLTVPredictions();
                    } else if (tabId === 'next-purchase') {
                        updateNextPurchasePredictions();
                    }
                });
            });
            
            // Segment selector
            document.getElementById('segmentSelector').addEventListener('change', updateSegmentDetails);
        }
        
        function initializeEventListeners() {
            // File upload
            const uploadArea = document.getElementById('uploadArea');
            const fileInput = document.getElementById('fileInput');
            const browseBtn = document.getElementById('browseBtn');
            const processDataBtn = document.getElementById('processDataBtn');
            const analyzeDataBtn = document.getElementById('analyzeDataBtn');
            const samplingSlider = document.getElementById('samplingSlider');
            const samplingValue = document.getElementById('samplingValue');
            
            browseBtn.addEventListener('click', () => fileInput.click());
            
            fileInput.addEventListener('change', handleFileSelect);
            
            uploadArea.addEventListener('dragover', (e) => {
                e.preventDefault();
                uploadArea.classList.add('dragover');
            });
            
            uploadArea.addEventListener('dragleave', () => {
                uploadArea.classList.remove('dragover');
            });
            
            uploadArea.addEventListener('drop', (e) => {
                e.preventDefault();
                uploadArea.classList.remove('dragover');
                
                if (e.dataTransfer.files.length) {
                    fileInput.files = e.dataTransfer.files;
                    handleFileSelect();
                }
            });
            
            processDataBtn.addEventListener('click', processData);
            analyzeDataBtn.addEventListener('click', analyzeData);
            
            // Sampling slider
            samplingSlider.addEventListener('input', function() {
                samplingValue.textContent = this.value + '%';
            });
            
            // Segmentation buttons
            document.getElementById('runSegmentationBtn').addEventListener('click', runSegmentation);
            document.getElementById('exportSegmentsBtn').addEventListener('click', exportSegments);
            document.getElementById('generateProfilesBtn').addEventListener('click', generateCustomerProfiles);
            
            // Analytics buttons
            document.getElementById('runAdvancedAnalyticsBtn').addEventListener('click', runAdvancedAnalytics);
            document.getElementById('runClusteringBtn').addEventListener('click', runClustering);
            document.getElementById('clusterSlider').addEventListener('input', function() {
                document.getElementById('clusterValue').textContent = this.value;
            });
            
            // Predictions buttons
            document.getElementById('runPredictionsBtn').addEventListener('click', runPredictions);
            
            // Reports buttons
            document.getElementById('generateReportBtn').addEventListener('click', generateFullReport);
            document.getElementById('buildReportBtn').addEventListener('click', buildCustomReport);
        }
        
        function initializeSampleCharts() {
            // Sample segmentation chart
            Plotly.newPlot('segmentation-chart', [{
                values: [12, 23, 35, 30],
                labels: ['Platinum', 'Gold', 'Silver', 'Bronze'],
                type: 'pie',
                marker: {
                    colors: ['#E5E4E2', '#FFD700', '#C0C0C0', '#CD7F32']
                }
            }], {
                title: 'Customer Segments',
                height: 350
            });
            
            // Sample trend chart
            const months = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun'];
            Plotly.newPlot('trend-chart', [{
                x: months,
                y: [120, 150, 180, 160, 200, 240],
                type: 'scatter',
                mode: 'lines+markers',
                name: 'Revenue',
                line: { color: '#3498db' }
            }, {
                x: months,
                y: [85, 92, 78, 88, 94, 102],
                type: 'scatter',
                mode: 'lines+markers',
                name: 'Customers',
                line: { color: '#2ecc71' }
            }], {
                title: 'Revenue & Customer Trends',
                height: 350
            });
            
            // Sample RFM chart
            Plotly.newPlot('rfm-chart', [{
                x: [1, 2, 3, 4, 5],
                y: [120, 85, 60, 40, 25],
                type: 'bar',
                name: 'Recency',
                marker: { color: '#3498db' }
            }, {
                x: [1, 2, 3, 4, 5],
                y: [25, 40, 60, 85, 120],
                type: 'bar',
                name: 'Frequency',
                marker: { color: '#2ecc71' }
            }, {
                x: [1, 2, 3, 4, 5],
                y: [30, 45, 75, 100, 110],
                type: 'bar',
                name: 'Monetary',
                marker: { color: '#e74c3c' }
            }], {
                title: 'RFM Distribution',
                barmode: 'group',
                height: 350
            });
        }
        
        function initializeSampleData() {
            // Generate sample data for demonstration
            currentData = generateSampleData();
            processedData = processSampleData(currentData);
            segmentationResults = performSegmentation(processedData);
            analyticsResults = performAdvancedAnalytics(processedData, segmentationResults);
            predictionResults = generatePredictions(processedData, segmentationResults);
        }
        
        function generateSampleData() {
            // Generate sample customer data for demonstration
            const sampleData = [];
            const segments = ['Platinum', 'Gold', 'Silver', 'Bronze'];
            const products = ['Laptop', 'Smartphone', 'Tablet', 'Headphones', 'Monitor'];
            const regions = ['North', 'South', 'East', 'West'];
            
            for (let i = 1; i <= 1000; i++) {
                const segment = segments[Math.floor(Math.random() * segments.length)];
                const product = products[Math.floor(Math.random() * products.length)];
                const revenue = Math.floor(Math.random() * 1000) + 50;
                const orders = Math.floor(Math.random() * 20) + 1;
                const region = regions[Math.floor(Math.random() * regions.length)];
                
                sampleData.push({
                    CustomerID: `CUST${i.toString().padStart(5, '0')}`,
                    Name: `Customer ${i}`,
                    Segment: segment,
                    LastPurchase: new Date(Date.now() - Math.random() * 90 * 24 * 60 * 60 * 1000).toISOString().split('T')[0],
                    TotalRevenue: revenue,
                    TotalOrders: orders,
                    FavoriteProduct: product,
                    Region: region,
                    Age: Math.floor(Math.random() * 50) + 20,
                    Gender: Math.random() > 0.5 ? 'Male' : 'Female'
                });
            }
            
            return sampleData;
        }
        
        function processSampleData(data) {
            // Add calculated fields for analysis
            return data.map(customer => {
                const segmentWeights = {
                    'Platinum': 4,
                    'Gold': 3,
                    'Silver': 2,
                    'Bronze': 1
                };
                
                return {
                    ...customer,
                    CustomerValue: customer.TotalRevenue * segmentWeights[customer.Segment],
                    AvgOrderValue: customer.TotalRevenue / customer.TotalOrders,
                    DaysSincePurchase: Math.floor(Math.random() * 90) + 1
                };
            });
        }
        
        function performSegmentation(data) {
            // Perform segmentation analysis
            const segments = {};
            
            data.forEach(customer => {
                if (!segments[customer.Segment]) {
                    segments[customer.Segment] = [];
                }
                segments[customer.Segment].push(customer);
            });
            
            return {
                segments: segments,
                summary: {
                    totalCustomers: data.length,
                    segmentDistribution: {
                        'Platinum': segments['Platinum'] ? segments['Platinum'].length : 0,
                        'Gold': segments['Gold'] ? segments['Gold'].length : 0,
                        'Silver': segments['Silver'] ? segments['Silver'].length : 0,
                        'Bronze': segments['Bronze'] ? segments['Bronze'].length : 0
                    },
                    segmentMetrics: calculateSegmentMetrics(segments)
                }
            };
        }
        
        function calculateSegmentMetrics(segments) {
            const metrics = {};
            
            Object.keys(segments).forEach(segment => {
                const segmentData = segments[segment];
                metrics[segment] = {
                    count: segmentData.length,
                    avgRevenue: segmentData.reduce((sum, customer) => sum + customer.TotalRevenue, 0) / segmentData.length,
                    avgOrders: segmentData.reduce((sum, customer) => sum + customer.TotalOrders, 0) / segmentData.length,
                    avgOrderValue: segmentData.reduce((sum, customer) => sum + customer.TotalRevenue, 0) / 
                                  segmentData.reduce((sum, customer) => sum + customer.TotalOrders, 0),
                    avgDaysSincePurchase: segmentData.reduce((sum, customer) => sum + customer.DaysSincePurchase, 0) / segmentData.length
                };
            });
            
            return metrics;
        }
        
        function performAdvancedAnalytics(data, segmentation) {
            // Perform advanced analytics
            return {
                clustering: performClustering(data),
                trends: analyzeTrends(data),
                cohorts: performCohortAnalysis(data),
                correlations: calculateCorrelations(data)
            };
        }
        
        function generatePredictions(data, segmentation) {
            // Generate predictive models
            return {
                churn: predictChurn(data),
                ltv: predictLTV(data),
                nextPurchase: predictNextPurchase(data),
                propensity: calculatePropensityScores(data)
            };
        }
        
        // Placeholder functions for analytics and predictions
        function performClustering(data) { return {}; }
        function analyzeTrends(data) { return {}; }
        function performCohortAnalysis(data) { return {}; }
        function calculateCorrelations(data) { return {}; }
        function predictChurn(data) { return {}; }
        function predictLTV(data) { return {}; }
        function predictNextPurchase(data) { return {}; }
        function calculatePropensityScores(data) { return {}; }
        
        function handleFileSelect() {
            if (!fileInput.files.length) return;
            
            const file = fileInput.files[0];
            document.getElementById('fileName').textContent = `File: ${file.name} (${formatFileSize(file.size)})`;
            document.getElementById('fileInfo').classList.remove('hidden');
            document.getElementById('dataPreview').classList.add('hidden');
        }
        
        function processData() {
            document.getElementById('processingProgress').classList.remove('hidden');
            simulateProgress();
            
            // In a real application, you would process the data here
            setTimeout(() => {
                document.getElementById('processingProgress').classList.add('hidden');
                document.getElementById('dataPreview').classList.remove('hidden');
                showDataPreview(currentData);
            }, 2000);
        }
        
        function analyzeData() {
            // Show loading state
            const analyzeBtn = document.getElementById('analyzeDataBtn');
            const originalText = analyzeBtn.innerHTML;
            analyzeBtn.innerHTML = '<span class="loading"></span> Analyzing...';
            analyzeBtn.disabled = true;
            
            // In a real application, you would perform data analysis here
            setTimeout(() => {
                analyzeBtn.innerHTML = originalText;
                analyzeBtn.disabled = false;
                
                // Navigate to segmentation section
                document.querySelector('.nav-link[data-target="segmentation"]').click();
                
                // Run segmentation
                runSegmentation();
            }, 1500);
        }
        
        function runSegmentation() {
            // Show loading state
            const segBtn = document.getElementById('runSegmentationBtn');
            const originalText = segBtn.innerHTML;
            segBtn.innerHTML = '<span class="loading"></span> Segmenting...';
            segBtn.disabled = true;
            
            // In a real application, you would run segmentation algorithms here
            setTimeout(() => {
                segBtn.innerHTML = originalText;
                segBtn.disabled = false;
                
                // Update segmentation charts
                updateSegmentationCharts();
            }, 2000);
        }
        
        function updateSegmentationCharts() {
            // Update segmentation pie chart
            Plotly.newPlot('segmentation-pie-chart', [{
                values: [12, 23, 35, 30],
                labels: ['Platinum', 'Gold', 'Silver', 'Bronze'],
                type: 'pie',
                marker: {
                    colors: ['#E5E4E2', '#FFD700', '#C0C0C0', '#CD7F32']
                }
            }], {
                title: 'Customer Segments Distribution',
                height: 350
            });
            
            // Update segmentation bar chart
            Plotly.newPlot('segmentation-bar-chart', [{
                x: ['Platinum', 'Gold', 'Silver', 'Bronze'],
                y: [1240, 580, 210, 85],
                type: 'bar',
                name: 'Avg. Revenue',
                marker: { color: '#3498db' }
            }, {
                x: ['Platinum', 'Gold', 'Silver', 'Bronze'],
                y: [18, 9, 4, 1.5],
                type: 'bar',
                name: 'Avg. Orders',
                marker: { color: '#2ecc71' }
            }], {
                title: 'Segment Performance Metrics',
                barmode: 'group',
                height: 350
            });
        }
        
        function updateSegmentDetails() {
            const segment = document.getElementById('segmentSelector').value;
            
            // Update segment purchase trend
            Plotly.newPlot('segment-purchase-trend', [{
                x: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun'],
                y: [45, 52, 48, 61, 55, 68],
                type: 'scatter',
                mode: 'lines+markers',
                name: 'Monthly Revenue',
                line: { color: '#3498db' }
            }], {
                title: `${segment.charAt(0).toUpperCase() + segment.slice(1)} Segment - Purchase Trend`,
                height: 350
            });
            
            // Update segment product mix
            Plotly.newPlot('segment-product-mix', [{
                values: [35, 25, 20, 15, 5],
                labels: ['Electronics', 'Clothing', 'Home Goods', 'Accessories', 'Other'],
                type: 'pie',
                marker: {
                    colors: ['#3498db', '#2ecc71', '#e74c3c', '#f39c12', '#9b59b6']
                }
            }], {
                title: `${segment.charAt(0).toUpperCase() + segment.slice(1)} Segment - Product Mix`,
                height: 350
            });
            
            // Update segment insights
            const insights = {
                platinum: "Platinum customers are your most valuable segment, contributing 42% of total revenue despite representing only 12% of customers. They have high purchase frequency (18.2 orders/year) and are highly responsive to loyalty programs.",
                gold: "Gold customers represent a significant growth opportunity. They have good purchase frequency (9.5 orders/year) and respond well to cross-selling campaigns. Focus on increasing their average order value.",
                silver: "Silver customers are occasional shoppers with moderate spending. They respond well to seasonal promotions and email campaigns. Consider implementing a win-back strategy for those showing decreased engagement.",
                bronze: "Bronze customers are primarily one-time or infrequent shoppers. They are highly price-sensitive and respond well to discounts. Focus on converting them to more engaged segments through targeted onboarding."
            };
            
            document.getElementById('segment-insights').innerHTML = `
                <p><strong>Segment Overview:</strong> ${insights[segment]}</p>
                <p><strong>Recommendations:</strong></p>
                <ul>
                    <li>Implement targeted marketing campaigns for this segment</li>
                    <li>Develop segment-specific product recommendations</li>
                    <li>Create personalized communication strategies</li>
                    <li>Monitor engagement metrics for early intervention</li>
                </ul>
            `;
        }
        
        function updateSegmentComparison() {
            // Update comparison RFM chart
            Plotly.newPlot('comparison-rfm-chart', [{
                x: ['Platinum', 'Gold', 'Silver', 'Bronze'],
                y: [4.2, 3.1, 2.4, 1.8],
                type: 'bar',
                name: 'Recency Score',
                marker: { color: '#3498db' }
            }, {
                x: ['Platinum', 'Gold', 'Silver', 'Bronze'],
                y: [4.8, 3.5, 2.2, 1.5],
                type: 'bar',
                name: 'Frequency Score',
                marker: { color: '#2ecc71' }
            }, {
                x: ['Platinum', 'Gold', 'Silver', 'Bronze'],
                y: [4.9, 3.7, 2.5, 1.3],
                type: 'bar',
                name: 'Monetary Score',
                marker: { color: '#e74c3c' }
            }], {
                title: 'RFM Score Comparison by Segment',
                barmode: 'group',
                height: 350
            });
            
            // Update comparison LTV chart
            Plotly.newPlot('comparison-ltv-chart', [{
                x: ['Platinum', 'Gold', 'Silver', 'Bronze'],
                y: [4250, 1850, 750, 210],
                type: 'bar',
                name: 'Avg. Lifetime Value',
                marker: { color: '#9b59b6' }
            }], {
                title: 'Average Customer Lifetime Value by Segment',
                height: 350
            });
        }
        
        function generateCustomerProfiles() {
            // Show loading state
            const profileBtn = document.getElementById('generateProfilesBtn');
            const originalText = profileBtn.innerHTML;
            profileBtn.innerHTML = '<span class="loading"></span> Generating...';
            profileBtn.disabled = true;
            
            setTimeout(() => {
                profileBtn.innerHTML = originalText;
                profileBtn.disabled = false;
                
                // Update profile charts
                Plotly.newPlot('profile-demographics-chart', [{
                    x: ['18-24', '25-34', '35-44', '45-54', '55+'],
                    y: [15, 35, 28, 16, 6],
                    type: 'bar',
                    name: 'Age Distribution',
                    marker: { color: '#3498db' }
                }], {
                    title: 'Customer Age Distribution',
                    height: 350
                });
                
                Plotly.newPlot('profile-behavior-chart', [{
                    values: [42, 28, 18, 12],
                    labels: ['Mobile App', 'Website', 'In-Store', 'Phone'],
                    type: 'pie',
                    marker: {
                        colors: ['#3498db', '#2ecc71', '#e74c3c', '#f39c12']
                    }
                }], {
                    title: 'Preferred Shopping Channels',
                    height: 350
                });
            }, 1500);
        }
        
        function runAdvancedAnalytics() {
            // Show loading state
            const analyticsBtn = document.getElementById('runAdvancedAnalyticsBtn');
            const originalText = analyticsBtn.innerHTML;
            analyticsBtn.innerHTML = '<span class="loading"></span> Analyzing...';
            analyticsBtn.disabled = true;
            
            setTimeout(() => {
                analyticsBtn.innerHTML = originalText;
                analyticsBtn.disabled = false;
                
                // Update analytics tabs
                updateClusteringAnalysis();
                updateTrendAnalysis();
                updateCohortAnalysis();
                updateCorrelationAnalysis();
            }, 2000);
        }
        
        function runClustering() {
            // Show loading state
            const clusterBtn = document.getElementById('runClusteringBtn');
            const originalText = clusterBtn.innerHTML;
            clusterBtn.innerHTML = '<span class="loading"></span> Clustering...';
            clusterBtn.disabled = true;
            
            setTimeout(() => {
                clusterBtn.innerHTML = originalText;
                clusterBtn.disabled = false;
                
                updateClusteringAnalysis();
            }, 1500);
        }
        
        function updateClusteringAnalysis() {
            // Update cluster scatter plot
            Plotly.newPlot('cluster-scatter-plot', [{
                x: [15, 28, 45, 78],
                y: [18.5, 9.2, 4.1, 1.8],
                mode: 'markers',
                type: 'scatter',
                text: ['Platinum', 'Gold', 'Silver', 'Bronze'],
                marker: {
                    size: [20, 16, 12, 8],
                    color: ['#E5E4E2', '#FFD700', '#C0C0C0', '#CD7F32']
                }
            }], {
                title: 'Customer Clusters: Recency vs Frequency',
                xaxis: { title: 'Avg. Recency (days)' },
                yaxis: { title: 'Avg. Frequency' },
                height: 350
            });
        }
        
        function updateTrendAnalysis() {
            // Update revenue trend chart
            Plotly.newPlot('revenue-trend-chart', [{
                x: ['Q1', 'Q2', 'Q3', 'Q4'],
                y: [450, 520, 480, 610],
                type: 'scatter',
                mode: 'lines+markers',
                name: 'Total Revenue',
                line: { color: '#3498db' }
            }], {
                title: 'Quarterly Revenue Trend',
                height: 350
            });
        }
        
        function updateCohortAnalysis() {
            // Update cohort retention chart
            Plotly.newPlot('cohort-retention-chart', [{
                z: [[100, 78, 65, 52], [100, 82, 68, 55], [100, 85, 72, 58]],
                x: ['Month 1', 'Month 3', 'Month 6', 'Month 12'],
                y: ['Jan 2023', 'Feb 2023', 'Mar 2023'],
                type: 'heatmap',
                colorscale: 'Blues'
            }], {
                title: 'Cohort Retention Rates',
                height: 350
            });
        }
        
        function updateCorrelationAnalysis() {
            // Update correlation matrix
            Plotly.newPlot('correlation-matrix', [{
                z: [[1, 0.82, 0.76, 0.65], [0.82, 1, 0.68, 0.54], [0.76, 0.68, 1, 0.72], [0.65, 0.54, 0.72, 1]],
                x: ['Frequency', 'Monetary', 'Tenure', 'Avg Order Value'],
                y: ['Frequency', 'Monetary', 'Tenure', 'Avg Order Value'],
                type: 'heatmap',
                colorscale: 'RdBu'
            }], {
                title: 'Customer Metrics Correlation Matrix',
                height: 350
            });
        }
        
        function runPredictions() {
            // Show loading state
            const predictionsBtn = document.getElementById('runPredictionsBtn');
            const originalText = predictionsBtn.innerHTML;
            predictionsBtn.innerHTML = '<span class="loading"></span> Predicting...';
            predictionsBtn.disabled = true;
            
            setTimeout(() => {
                predictionsBtn.innerHTML = originalText;
                predictionsBtn.disabled = false;
                
                // Update prediction tabs
                updateChurnPredictions();
                updateLTVPredictions();
                updateNextPurchasePredictions();
            }, 2000);
        }
        
        function updateChurnPredictions() {
            // Update churn segment chart
            Plotly.newPlot('churn-segment-chart', [{
                x: ['Platinum', 'Gold', 'Silver', 'Bronze'],
                y: [5.8, 12.4, 23.6, 69.1],
                type: 'bar',
                marker: { color: '#e74c3c' }
            }], {
                title: 'Churn Rate by Segment',
                height: 350
            });
        }
        
        function updateLTVPredictions() {
            // Update LTV distribution chart
            Plotly.newPlot('ltv-distribution-chart', [{
                x: ['<$500', '$500-$1k', '$1k-$2k', '$2k-$5k', '>$5k'],
                y: [35, 28, 20, 12, 5],
                type: 'bar',
                marker: { color: '#3498db' }
            }], {
                title: 'Customer Lifetime Value Distribution',
                height: 350
            });
        }
        
        function updateNextPurchasePredictions() {
            // Update next purchase timing
            Plotly.newPlot('next-purchase-timing', [{
                x: ['<7 days', '7-14 days', '15-30 days', '31-60 days', '>60 days'],
                y: [12, 25, 35, 20, 8],
                type: 'bar',
                marker: { color: '#2ecc71' }
            }], {
                title: 'Predicted Time to Next Purchase',
                height: 350
            });
        }
        
        function generateFullReport() {
            alert('Full report generation started! This would typically create a comprehensive PDF report with all analytics and visualizations.');
        }
        
        function buildCustomReport() {
            alert('Custom report builder activated! This would allow users to select specific metrics, segments, and time periods for their report.');
        }
        
        function exportSegments() {
            alert('Segmentation data exported successfully!');
        }
        
        function simulateProgress() {
            const progressBar = document.getElementById('progressBar');
            const progressText = document.getElementById('progressText');
            let width = 0;
            
            const interval = setInterval(() => {
                if (width >= 100) {
                    clearInterval(interval);
                    progressText.textContent = 'Processing complete!';
                } else {
                    width += 5;
                    progressBar.style.width = width + '%';
                    progressText.textContent = `Processing... ${width}%`;
                }
            }, 100);
        }
        
        function showDataPreview(data) {
            // Create a simple table preview (first 10 rows)
            const previewTable = document.getElementById('previewTable');
            const headers = Object.keys(data[0]);
            
            let tableHTML = '<table class="data-table"><thead><tr>';
            
            // Create header row
            headers.forEach(header => {
                tableHTML += `<th>${header}</th>`;
            });
            
            tableHTML += '</tr></thead><tbody>';
            
            // Create data rows (first 10)
            data.slice(0, 10).forEach(row => {
                tableHTML += '<tr>';
                headers.forEach(header => {
                    tableHTML += `<td>${row[header]}</td>`;
                });
                tableHTML += '</tr>';
            });
            
            tableHTML += '</tbody></table>';
            previewTable.innerHTML = tableHTML;
        }
        
        function formatFileSize(bytes) {
            if (bytes === 0) return '0 Bytes';
            const k = 1024;
            const sizes = ['Bytes', 'KB', 'MB', 'GB'];
            const i = Math.floor(Math.log(bytes) / Math.log(k));
            return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];
        }
    </script>
</body>
</html>
